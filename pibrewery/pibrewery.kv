#:kivy 1.9
#:import chain itertools.chain
#:import Clock kivy.clock.Clock

ScreenManagement:
    id: sm
    name: 'screen manager'
    MainScreen:
    BrewingScreen
    FermentationScreen:

<Graph@Widget>:
    max: 100
    values: []
    canvas:
        SmoothLine:
            points:
                list(chain(*
                [[
                self.x + x * self.width / len(self.values),
                self.y + y * self.height / self.max
                ] for x, y in enumerate(self.values)])) if self.values else []

<MainScreen>:
    id: main
    name: 'main'
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 20
        BoxLayout:
            id: layout
            spacing: 20
            Button:
                on_release: app.root.current = 'brewing'
                text: 'Brewing'
                font_size: 50
            Button:
                on_release: app.root.current = 'fermentation'
                text: 'Fermentation'
                font_size: 50
        Button:
            on_release: app.get_running_app().stop()
            text: 'Close'
            font_size: 50

<BrewingScreen>:
    name: 'brewing'
    Button:
        on_release: app.root.current = 'main'
        text: 'back to the home screen'
        font_size: 50

<FermentationScreen>:
    id: ferm_screen
    name: 'fermentation'
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            Label:
                text: 'Temperature'
            Label:
                text: '64'
            Label:
                text: 'F'
            ToggleButton:
                text: 'Start'
                on_state:
                    if self.state == 'down':Clock.schedule_interval(app.update_fermentation_plot, 1)
                    else:Clock.unschedule(app.update_fermentation_plot)
            Button:
                on_release: app.root.current = 'main'
                text: 'Home'
        Graph:
            id: ferm_graph
            ylabel: 'Temperature'
            x_grid: True
            y_grid: True
            y_ticks_major: 5
            x_ticks_major: 10
            max: 100
            values: app.running_values
